!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("node:os"),require("node:child_process"),require("node:fs"),require("node:path"),require("node:url")):"function"==typeof define&&define.amd?define(["exports","node:os","node:child_process","node:fs","node:path","node:url"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).nodeVgmstreamWrapper={},e.os,e.node_child_process,e.fs,e.path,e.node_url)}(this,(function(e,n,r,i,o,t){"use strict";var s="undefined"!=typeof document?document.currentScript:null;const c=o.dirname(t.fileURLToPath("undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:s&&"SCRIPT"===s.tagName.toUpperCase()&&s.src||new URL("node-vgmstream-wrapper.min.js",document.baseURI).href)),m={linux:o.join(c,"../src/vgmstream-linux-cli/vgmstream-cli"),mac:o.join(c,"../src/vgmstream-mac-cli/vgmstream-cli"),wasm:o.join(c,"../src/vgmstream-wasm/vgmstream-cli.wasm"),win:o.join(c,"../src/vgmstream-win/vgmstream-cli.exe"),win64:o.join(c,"../src/vgmstream-win64/vgmstream-cli.exe"),linux:o.join(c,"../src/vgmstream-linux-cli/vgmstream-cli"),darwin:o.join(c,"../src/vgmstream-mac-cli/vgmstream-cli"),win32:o.join(c,"../src/vgmstream-win64/vgmstream-cli.exe")},a=o.join(c,"../.vgmstream");e.decode=async function(e){i.existsSync(a)&&i.rmSync(a,{recursive:!0}),i.mkdirSync(a,{recursive:!0});const t=m[n.platform()];return await function(...e){return new Promise((function(n,i){let o="",t="";const s=r.spawn(e.shift(),e);s.stdout.on("data",(function(e){o+=e.toString()})),s.stderr.on("data",(function(e){t+=e.toString()})),s.on("error",(function(e){i(e)})),s.on("exit",(function(e,r){n({stdout:o,stderr:t})}))}))}(t,"-S","0","-o",o.join(a,"?n.wav"),o.resolve(e)),i.readdirSync(a).map((e=>({filename:e,buffer:i.readFileSync(o.join(a,e))})))}}));
