"use strict";var e=require("node:os"),r=require("node:child_process"),n=require("node:fs"),i=require("node:path"),t=require("node:url"),m="undefined"!=typeof document?document.currentScript:null;const s=i.dirname(t.fileURLToPath("undefined"==typeof document?require("url").pathToFileURL(__filename).href:m&&"SCRIPT"===m.tagName.toUpperCase()&&m.src||new URL("node-vgmstream-wrapper.min.cjs",document.baseURI).href)),c={linux:i.join(s,"../src/vgmstream-linux-cli/vgmstream-cli"),mac:i.join(s,"../src/vgmstream-mac-cli/vgmstream-cli"),wasm:i.join(s,"../src/vgmstream-wasm/vgmstream-cli.wasm"),win:i.join(s,"../src/vgmstream-win/vgmstream-cli.exe"),win64:i.join(s,"../src/vgmstream-win64/vgmstream-cli.exe"),linux:i.join(s,"../src/vgmstream-linux-cli/vgmstream-cli"),darwin:i.join(s,"../src/vgmstream-mac-cli/vgmstream-cli"),win32:i.join(s,"../src/vgmstream-win64/vgmstream-cli.exe")},o=i.join(s,"../.vgmstream");exports.decode=async function(t){n.existsSync(o)&&n.rmSync(o,{recursive:!0}),n.mkdirSync(o,{recursive:!0});const m=c[e.platform()];return await function(...e){return new Promise((function(n,i){let t="",m="";const s=r.spawn(e.shift(),e);s.stdout.on("data",(function(e){t+=e.toString()})),s.stderr.on("data",(function(e){m+=e.toString()})),s.on("error",(function(e){i(e)})),s.on("exit",(function(e,r){n({stdout:t,stderr:m})}))}))}(m,"-S","0","-o",i.join(o,"?n.wav"),i.resolve(t)),n.readdirSync(o).map((e=>({filename:e,buffer:n.readFileSync(i.join(o,e))})))};
