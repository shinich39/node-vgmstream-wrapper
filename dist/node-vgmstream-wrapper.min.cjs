"use strict";var e=require("node:os"),r=require("node:child_process"),n=require("node:fs"),i=require("node:path"),t=require("node:url"),s="undefined"!=typeof document?document.currentScript:null;const m=i.dirname(t.fileURLToPath("undefined"==typeof document?require("url").pathToFileURL(__filename).href:s&&"SCRIPT"===s.tagName.toUpperCase()&&s.src||new URL("node-vgmstream-wrapper.min.cjs",document.baseURI).href)),c={linux:i.join(m,"../src/vgmstream-linux-cli/vgmstream-cli"),mac:i.join(m,"../src/vgmstream-mac-cli/vgmstream-cli"),wasm:i.join(m,"../src/vgmstream-wasm/vgmstream-cli.wasm"),win:i.join(m,"../src/vgmstream-win/vgmstream-cli.exe"),win64:i.join(m,"../src/vgmstream-win64/vgmstream-cli.exe"),linux:i.join(m,"../src/vgmstream-linux-cli/vgmstream-cli"),darwin:i.join(m,"../src/vgmstream-mac-cli/vgmstream-cli"),win32:i.join(m,"../src/vgmstream-win64/vgmstream-cli.exe")},o=i.join(process.cwd(),".vgmstream");exports.decode=async function(t){n.existsSync(o)&&n.rmSync(o,{recursive:!0}),n.mkdirSync(o,{recursive:!0});const s=c[e.platform()];return await function(...e){return new Promise((function(n,i){let t="",s="";const m=r.spawn(e.shift(),e);m.stdout.on("data",(function(e){t+=e.toString()})),m.stderr.on("data",(function(e){s+=e.toString()})),m.on("error",(function(e){i(e)})),m.on("exit",(function(e,r){n({stdout:t,stderr:s})}))}))}(s,"-S","0","-o",i.join(o,"?n.wav"),i.resolve(t)),n.readdirSync(o).map((e=>({filename:e,buffer:n.readFileSync(i.join(o,e))})))};
